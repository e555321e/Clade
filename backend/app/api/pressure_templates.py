"""
å‹åŠ›æ¨¡æ¿ - é™æ€ç¯å¢ƒå‹åŠ›å®šä¹‰

æ­¤æ¨¡å—åŒ…å«é¢„å®šä¹‰çš„å‹åŠ›æ¨¡æ¿ï¼Œå¯åœ¨æ¨¡æ‹Ÿå›åˆä¸­åº”ç”¨ã€‚
æ¯ä¸ªæ¨¡æ¿ä»£è¡¨å½±å“ç‰©ç§ç”Ÿå­˜å’Œæ¼”åŒ–çš„ç¯å¢ƒæ¡ä»¶æˆ–äº‹ä»¶ã€‚

åˆ†ç±»ï¼š
- æ°”å€™ï¼šæ¸©åº¦å’Œé™æ°´å˜åŒ–
- åœ°è´¨ï¼šæ„é€ å’Œç«å±±äº‹ä»¶
- ç”Ÿæ€ï¼šèµ„æºå’Œç”Ÿç‰©å‹åŠ›
- å¤§æ°”ï¼šæ°§æ°”å’ŒåŒ–å­¦å˜åŒ–
"""

from __future__ import annotations

from ..schemas.responses import PressureTemplate
from ..simulation.constants import (
    PRESSURE_TYPE_TIERS, 
    TIER_1_BASE_COST, 
    TIER_2_BASE_COST, 
    TIER_3_BASE_COST
)

def _create_template(kind: str, label: str, description: str) -> PressureTemplate:
    """è¾…åŠ©å‡½æ•°ï¼šè‡ªåŠ¨å¡«å……tierå’Œbase_cost"""
    tier = PRESSURE_TYPE_TIERS.get(kind, 2)  # é»˜è®¤ä¸ºä¸­ç­‰
    
    cost = TIER_2_BASE_COST
    if tier == 1:
        cost = TIER_1_BASE_COST
    elif tier == 3:
        cost = TIER_3_BASE_COST
        
    # è‡ªç„¶æ¼”åŒ–ç‰¹ä¾‹ï¼š0æ¶ˆè€—
    if kind == "natural_evolution":
        cost = 0
        
    return PressureTemplate(
        kind=kind,
        label=label,
        description=description,
        tier=tier,
        base_cost=cost
    )

# ç¯å¢ƒå‹åŠ›æ¨¡æ¿
PRESSURE_TEMPLATES: list[PressureTemplate] = [
    # ==========================================
    # Tier 1: ç”Ÿæ€/è½»å¾®æ³¢åŠ¨ (Base Cost: 5)
    # ==========================================
    _create_template(
        kind="natural_evolution",
        label="ğŸŒ± è‡ªç„¶æ¼”åŒ–",
        description="è®©ç”Ÿæ€ç³»ç»Ÿè‡ªç„¶å‘å±•ï¼Œä¸æ–½åŠ ç¥åœ£å¹²é¢„ã€‚"
                   "ç‰©ç§æŒ‰ç…§è‡ªç„¶é€‰æ‹©ä¸ç¯å¢ƒäº¤äº’ã€‚"
                   "æ¶ˆè€— 0 ç‚¹ç¥åœ£èƒ½é‡ã€‚"
    ),
    _create_template(
        kind="fog_period",
        label="é›¾éœ¾æœŸ",
        description="å¤§æ°”æ¹¿åº¦å¢åŠ ï¼ŒæŒç»­é›¾éœ¾å‡å°‘æ—¥ç…§ã€‚"
                   "å…‰åˆä½œç”¨å—é™ï¼Œç”Ÿç‰©å¯èƒ½éœ€è¦é™ä½èƒ½é‡éœ€æ±‚æˆ–ä¾èµ–å…¶ä»–èƒ½æºã€‚"
    ),
    _create_template(
        kind="resource_abundance",
        label="èµ„æºä¸°å¯Œ",
        description="ç¯å¢ƒèµ„æºå……æ²›ï¼Œç”Ÿæ€ä½å¼€æ”¾ï¼Œç”Ÿç‰©æ¼”åŒ–å’Œåˆ†åŒ–åŠ é€Ÿï¼Œ"
                   "äº§ç”Ÿæ›´å¤šç‹¬ç‰¹çš„å½¢æ€å’Œç”Ÿæ€ç­–ç•¥ã€‚"
    ),
    _create_template(
        kind="productivity_decline",
        label="ç”Ÿäº§åŠ›ä¸‹é™",
        description="åˆçº§ç”Ÿäº§è€…æ•°é‡å‡å°‘ï¼Œé£Ÿç‰©é“¾åŸºç¡€å—å½±å“ã€‚"
                   "ç‰©ç§éœ€è¦é™ä½èƒ½é‡æ¶ˆè€—ã€æ”¹å˜é£Ÿæ€§æˆ–å‘å±•æŠ—é€†æ€§ã€‚"
    ),
    _create_template(
        kind="monsoon_shift",
        label="å­£é£è½¬ç§»",
        description="é£å‘æ¨¡å¼æ”¹å˜ï¼Œéƒ¨åˆ†åœ°åŒºä»æ¹¿æ¶¦è½¬ä¸ºå¹²æ—±ã€‚"
                   "ç‰©ç§éœ€è¦è°ƒæ•´åˆ†å¸ƒèŒƒå›´æˆ–é€‚åº”æ–°çš„æ°”å€™ç»„åˆã€‚"
    ),
    _create_template(
        kind="predator_rise",
        label="æ•é£Ÿè€…å´›èµ·",
        description="æ–°çš„æ•é£Ÿè€…å‡ºç°ï¼Œæ•é£Ÿå‹åŠ›å¢åŠ ã€‚"
                   "å…¶ä»–ç‰©ç§éœ€è¦å‘å±•æ›´æœ‰æ•ˆçš„é˜²å¾¡ã€éšè”½æˆ–é€ƒé€¸èƒ½åŠ›ã€‚"
    ),
    _create_template(
        kind="disease_outbreak",
        label="ç–¾ç—…çˆ†å‘",
        description="ä¼ æŸ“ç—…åœ¨ç§ç¾¤é—´ä¼ æ’­ï¼Œè€ƒéªŒå…ç–«ç³»ç»Ÿã€‚"
                   "é«˜å¯†åº¦ç§ç¾¤å—å½±å“æœ€å¤§ï¼Œä¿ƒè¿›å…ç–«åŸºå› æ¼”åŒ–ã€‚"
    ),

    # ==========================================
    # Tier 2: æ°”å€™/æ˜¾è‘—å˜åŒ– (Base Cost: 20)
    # ==========================================
    _create_template(
        kind="glacial_period",
        label="å†°å·æœŸ",
        description="æ°”æ¸©ä¸‹é™ï¼Œå†°å·æ‰©å¼ ï¼Œç¯å¢ƒè¶‹å‘å¯’å†·ã€‚"
                   "å¯¹è€å¯’èƒ½åŠ›ä½çš„ç‰©ç§å½¢æˆå‹åŠ›ã€‚ç”Ÿç‰©éœ€è¦å‘å±•ä¿æ¸©ç»“æ„ã€‚"
    ),
    _create_template(
        kind="greenhouse_earth",
        label="æ¸©å®¤åœ°çƒ",
        description="æ°”æ¸©ä¸Šå‡ï¼Œæåœ°å†°ç›–å‡å°‘ï¼Œæµ·å¹³é¢å˜åŒ–å½±å“æ²¿æµ·æ –æ¯åœ°ã€‚"
                   "ç‰©ç§éœ€è¦æé«˜æ•£çƒ­èƒ½åŠ›æˆ–é€‚åº”æ›´æ½®æ¹¿çš„ç¯å¢ƒã€‚"
    ),
    _create_template(
        kind="pluvial_period",
        label="å¤šé›¨æœŸ",
        description="é™æ°´å¢åŠ ï¼Œå½¢æˆæ¹¿åœ°å’Œæ¹–æ³Šã€‚é™†åœ°æ –æ¯åœ°å‡å°‘ï¼Œ"
                   "æ°´ç”Ÿå’Œä¸¤æ –ç‰©ç§è·å¾—æ›´å¤šç”Ÿå­˜ç©ºé—´ã€‚"
    ),
    _create_template(
        kind="drought_period",
        label="å¹²æ—±æœŸ",
        description="é™æ°´å‡å°‘ï¼Œæ¤è¢«è¡°é€€ï¼Œæ°´æºç¨€ç¼ºã€‚"
                   "ç‰©ç§éœ€è¦æé«˜ä¿æ°´èƒ½åŠ›ã€å‡å°‘è’¸å‘æ•£å¤±ã€‚"
    ),
    _create_template(
        kind="land_degradation",
        label="åœŸåœ°é€€åŒ–",
        description="è¡¨å±‚åœŸå£¤æµå¤±ï¼Œæ¤è¢«ç”Ÿé•¿å—é™ã€‚"
                   "ç‰©ç§å¯èƒ½è½¬å‘ä½è¥å…»ç­–ç•¥æˆ–æ”¹å˜é£Ÿæ€§ä»¥æ±‚ç”Ÿå­˜ã€‚"
    ),
    _create_template(
        kind="ocean_current_shift",
        label="æ´‹æµå˜åŒ–",
        description="æµ·æ´‹ç¯æµæ”¹å˜æ²¿æµ·æ°”å€™ï¼Œä½¿æŸäº›åœ°åŒºå˜æš–æˆ–å˜å†·ã€‚"
                   "ä¾èµ–ç¨³å®šç¯å¢ƒçš„ç‰©ç§éœ€è¦è°ƒæ•´åˆ†å¸ƒæˆ–é€‚åº”æ–°æ¸©åº¦ã€‚"
    ),
    _create_template(
        kind="species_invasion",
        label="ç‰©ç§å…¥ä¾µ",
        description="å¤–æ¥ç‰©ç§è¿›å…¥ç”Ÿæ€ç³»ç»Ÿï¼Œé€šè¿‡ç«äº‰æˆ–ç¹æ®–ç‡å½±å“æœ¬åœ°ç‰©ç§ã€‚"
                   "æœ¬åœ°ç‰©ç§å¯èƒ½è¢«è¿«è¿ç§»æˆ–æ¼”åŒ–æ–°ç­–ç•¥ã€‚"
    ),
    _create_template(
        kind="oxygen_increase",
        label="æ°§æ°”å¢åŠ ",
        description="å¤§æ°”æ°§æ°”å«é‡ä¸Šå‡ï¼Œä½¿ç”Ÿç‰©èƒ½å¤Ÿå‘å±•æ›´å¤§çš„ä½“å‹ã€"
                   "æ›´é«˜çš„ä»£è°¢ç‡æˆ–æ›´å¼ºçš„è¿åŠ¨èƒ½åŠ›ã€‚"
    ),
    _create_template(
        kind="wildfire_period",
        label="é‡ç«è‚†è™",
        description="å¹²ç‡¥æ°”å€™å¯¼è‡´é¢‘ç¹çš„é‡ç«ã€‚"
                   "è€ç«æ¤ç‰©å’Œç©´å±…åŠ¨ç‰©è·å¾—ä¼˜åŠ¿ï¼Œæ£®æ—ç¯å¢ƒå—åˆ°é‡åˆ›ã€‚"
    ),
    _create_template(
        kind="algal_bloom",
        label="è—»åçˆ†å‘",
        description="æ°´ä½“å¯Œè¥å…»åŒ–å¯¼è‡´è—»ç±»ç–¯é•¿ï¼Œæ¶ˆè€—æ°§æ°”å¹¶å¯èƒ½äº§ç”Ÿæ¯’ç´ ã€‚"
                   "æ°´ç”Ÿç”Ÿç‰©é¢ä¸´çª’æ¯å’Œä¸­æ¯’é£é™©ã€‚"
    ),
    _create_template(
        kind="uv_radiation_increase",
        label="ç´«å¤–è¾å°„å¢å¼º",
        description="è‡­æ°§å±‚å˜è–„ï¼Œåœ°è¡¨ç´«å¤–çº¿å¢å¼ºã€‚"
                   "ç”Ÿç‰©éœ€è¦å‘å±•é˜²æŠ¤è‰²ç´ ã€å¤œè¡Œä¹ æ€§æˆ–ä¿®å¤æœºåˆ¶ã€‚"
    ),
    _create_template(
        kind="salinity_change",
        label="ç›åº¦éœ‡è¡",
        description="æ°´ä½“ç›åº¦å‘ç”Ÿæ˜¾è‘—æ³¢åŠ¨ã€‚"
                   "å¹¿ç›æ€§ç”Ÿç‰©å­˜æ´»ï¼Œç‹­ç›æ€§ç”Ÿç‰©é¢ä¸´æ¸—é€å‹è°ƒèŠ‚å´©æºƒã€‚"
    ),

    # ==========================================
    # Tier 3: æ¯ç­/åœ°è´¨å¤©ç¾ (Base Cost: 100)
    # ==========================================
    _create_template(
        kind="volcanic_eruption",
        label="ç«å±±å¤§çˆ†å‘",
        description="è¶…çº§ç«å±±æ´»åŠ¨é®è”½é˜³å…‰ï¼Œé…¸åŒ–æµ·æ´‹ï¼Œé€ æˆå…¨çƒæ€§é™æ¸©ã€‚"
                   "ç”Ÿæ€ç³»ç»Ÿå´©æºƒï¼Œä»…å°‘æ•°é¡½å¼ºç‰©ç§èƒ½å¹¸å­˜ã€‚"
    ),
    _create_template(
        kind="orogeny",
        label="é€ å±±è¿åŠ¨",
        description="å‰§çƒˆçš„åœ°å£³æŠ¬å‡é˜»æ–­æ°”æµï¼Œå½»åº•æ”¹å˜å¤§é™†æ°”å€™æ ¼å±€ã€‚"
                   "åŸæœ‰æ –æ¯åœ°ç ´ç¢åŒ–ï¼Œç‰©ç§é¢ä¸´åœ°ç†éš”ç¦»å’Œç”Ÿå¢ƒå‰§å˜ã€‚"
    ),
    _create_template(
        kind="subsidence",
        label="é™†æ¶æ²‰é™",
        description="å¤§é¢ç§¯é™†åœ°æ²‰å…¥æµ·åº•ï¼Œæ²¿æµ·ç”Ÿæ€ç³»ç»Ÿè¢«æ·¹æ²¡ã€‚"
                   "é™†ç”Ÿç”Ÿç‰©æ –æ¯åœ°æ€¥å‰§ä¸§å¤±ï¼Œè¿«ä½¿ç‰©ç§å‘å†…é™†è¿å¾™æˆ–ç­ç»ã€‚"
    ),
    _create_template(
        kind="ocean_acidification",
        label="æµ·æ´‹é…¸åŒ–",
        description="æµ·æ°´pHå€¼å‰§é™ï¼Œç¢³é…¸é’™å¤–å£³æº¶è§£ã€‚"
                   "æµ·æ´‹é£Ÿç‰©ç½‘åŸºç¡€å´©æºƒï¼Œé’™è´¨ç”Ÿç‰©é¢ä¸´ç­é¡¶ä¹‹ç¾ã€‚"
    ),
    _create_template(
        kind="anoxic_event",
        label="å¤§ç¼ºæ°§äº‹ä»¶",
        description="æµ·æ´‹å¾ªç¯åœæ»ï¼Œæ·±æµ·å˜æˆæ­»åŒºã€‚"
                   "å¥½æ°§ç”Ÿç‰©å¤§é‡æ­»äº¡ï¼ŒåŒæ°§èŒç¹ç››å¹¶é‡Šæ”¾æ¯’æ°”ã€‚"
    ),
    _create_template(
        kind="sulfide_event",
        label="æ¯’æ°”å–·å‘",
        description="ç¡«åŒ–æ°¢ä»æµ·æ´‹é‡Šæ”¾åˆ°å¤§æ°”ï¼Œæ¯’å®³é™†åœ°ç”Ÿç‰©å¹¶ç ´åè‡­æ°§å±‚ã€‚"
                   "è¿™æ˜¯ä¸€åœºé’ˆå¯¹å‘¼å¸ç³»ç»Ÿçš„åŒ–å­¦å± æ€ã€‚"
    ),
    _create_template(
        kind="methane_release",
        label="ç”²çƒ·æª",
        description="æµ·åº•ç”²çƒ·æ°´åˆç‰©åˆ†è§£é‡Šæ”¾ï¼Œå¯¼è‡´æ°”æ¸©åœ¨çŸ­æ—¶é—´å†…å‰§çƒˆé£™å‡ã€‚"
                   "çƒ­æµªå’Œæ°”å€™æ··ä¹±æ‘§æ¯å¤§å¤šæ•°é€‚åº”ç¨³å®šæ°”å€™çš„ç‰©ç§ã€‚"
    ),
    _create_template(
        kind="extreme_weather",
        label="æç«¯é£æš´",
        description="å…¨çƒæ€§çš„è¶…çº§é£æš´ç³»ç»Ÿï¼Œæ‘§æ¯åœ°è¡¨æ¤è¢«å’Œæ²¿æµ·ç¯å¢ƒã€‚"
                   "ç‰©ç†ç ´ååŠ›æå¼ºï¼Œä¸ä»…æ˜¯æ°”å€™é—®é¢˜ï¼Œæ›´æ˜¯ç”Ÿå­˜æŒ‘æˆ˜ã€‚"
    ),
    _create_template(
        kind="sea_level_rise",
        label="æµ·ä¾µ",
        description="æµ·å¹³é¢å¤§å¹…ä¸Šå‡ï¼Œç°æœ‰é™†åœ°å¤§å¹…å‡å°‘ã€‚"
                   "ä½åœ°ç”Ÿç‰©ç­ç»ï¼Œç”Ÿæ€ç³»ç»Ÿå‘é«˜åœ°å‰§çƒˆå‹ç¼©ã€‚"
    ),
    _create_template(
        kind="sea_level_fall",
        label="æµ·é€€",
        description="æµ·å¹³é¢å¤§å¹…ä¸‹é™ï¼Œå¤§é™†æ¶æš´éœ²ï¼Œæµ…æµ·ç”Ÿæ€ç³»ç»Ÿæ¶ˆå¤±ã€‚"
                   "æµ·æ´‹ç”Ÿç‰©å¤šæ ·æ€§é­å—é‡åˆ›ï¼Œæ°”å€™å˜å¾—æç«¯å¹²ç‡¥ã€‚"
    ),
    _create_template(
        kind="earthquake_period",
        label="å¼ºéœ‡æœŸ",
        description="æ¿å—å‰§çƒˆè¿åŠ¨ï¼ŒæŒç»­çš„å¤§åœ°éœ‡æ”¹å˜åœ°å½¢å¹¶å¼•å‘æµ·å•¸ã€‚"
                   "æ –æ¯åœ°ç‰©ç†ç»“æ„è¢«ç ´åï¼Œåœ°è´¨ç¯å¢ƒæä¸ç¨³å®šã€‚"
    ),
    _create_template(
        kind="meteor_impact",
        label="é™¨çŸ³æ’å‡»",
        description="å¤©å¤–æ¥å®¢æ’å‡»åœ°çƒï¼Œå¼•å‘å†²å‡»æ³¢ã€æµ·å•¸å’Œå…¨çƒå°˜åŸƒäº‘ã€‚"
                   "ç¬é—´çš„æ¯ç­éšåæ˜¯æ¼«é•¿çš„æ’å‡»å†¬å¤©ï¼Œå…‰åˆä½œç”¨å‡ ä¹åœæ­¢ã€‚"
    ),
    _create_template(
        kind="gamma_ray_burst",
        label="ä¼½é©¬å°„çº¿æš´",
        description="æ¥è‡ªæ·±ç©ºçš„è‡´å‘½è¾å°„å‰¥ç¦»è‡­æ°§å±‚ï¼Œæ€æ­»è¡¨å±‚ç”Ÿç‰©ã€‚"
                   "å¹¸å­˜è€…é¢ä¸´åŸºå› å´©æºƒå’Œéšåçš„ç”Ÿæ€è’æ¼ åŒ–ã€‚"
    ),
]


def get_pressure_templates() -> list[PressureTemplate]:
    """è·å–æ‰€æœ‰å¯ç”¨çš„å‹åŠ›æ¨¡æ¿"""
    return PRESSURE_TEMPLATES


def get_pressure_template(kind: str) -> PressureTemplate | None:
    """æ ¹æ®ç±»å‹è·å–ç‰¹å®šå‹åŠ›æ¨¡æ¿"""
    for template in PRESSURE_TEMPLATES:
        if template.kind == kind:
            return template
    return None
